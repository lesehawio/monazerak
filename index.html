<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>بازی مناظرک</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f5f5f5;
      text-align: center;
      direction: rtl;
    }
    .player {
      border: 2px solid #333;
      border-radius: 12px;
      padding: 10px;
      margin: 10px;
      display: inline-block;
      background-color: #ffffff;
      width: 220px;
      position: relative;
    }
    .player.pastel-1 { background-color: #ffe6e6; }
    .player.pastel-2 { background-color: #e6ffe6; }
    .player.pastel-3 { background-color: #e6e6ff; }
    .player.pastel-4 { background-color: #fff0e6; }
    .player.pastel-5 { background-color: #f0e6ff; }
    .player.pastel-6 { background-color: #e6ffff; }
    .turn { border: 3px solid #007bff; }
    .log {
      background-color: #eaeaea;
      max-height: 200px;
      overflow-y: auto;
      padding: 10px;
      margin: 20px auto;
      width: 90%;
      text-align: right;
    }
    .buttons button {
      margin: 4px;
      padding: 6px 12px;
      border-radius: 6px;
    }
    #scoreBoard {
      margin-top: 20px;
      font-weight: bold;
    }
    #topicBox, #logicBox {
      background-color: #fff3cd;
      padding: 10px;
      margin: 15px auto;
      width: 80%;
      border-radius: 8px;
      border: 1px solid #ffeeba;
      font-size: 18px;
    }
    .logic-options button {
      margin: 4px;
      padding: 6px 12px;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <h1>🎴 بازی مناظرک</h1>

  <div id="setup">
    <h2>افزودن بازیکنان</h2>
    <input type="text" id="newPlayer" placeholder="نام بازیکن">
    <button onclick="addPlayer()">➕ افزودن</button>
    <button onclick="startGame()">🎮 شروع بازی</button>
    <div id="playerList"></div>
  </div>

  <div id="game" style="display: none;">
    <div id="topicBox">🔍 موضوع مناظره: <span id="topicText">—</span></div>
    <div id="logicBox">
      🧠 منطق مناظره: <span id="currentLogic">استدلال منطقی و علمی (♦)</span>
      <div class="logic-options">
        <button onclick="setLogic('♦', 'منطقی و علمی')">♦ منطقی و علمی</button>
        <button onclick="setLogic('♠', 'سیاسی و قدرتی')">♠ سیاسی و قدرتی</button>
        <button onclick="setLogic('♥', 'احساسی')">♥ احساسی</button>
        <button onclick="setLogic('♣', 'فلسفی و اخلاقی')">♣ فلسفی و اخلاقی</button>
      </div>
    </div>
    <h2>بازیکنان</h2>
    <div id="players"></div>
    <h3>نوبت: <span id="currentPlayerName"></span></h3>
    <div id="timer">زمان باقی‌مانده: <span id="timeLeft">۰</span> ثانیه</div>
    <div class="log" id="log"></div>
    <div id="scoreBoard">🎯 امتیازها: <span id="scores"></span></div>
  </div>

  <script>
    let players = [];
    let currentPlayerIndex = 0;
    let turnTimer;
    let timeLeft = 0; // زمان اولیه صفر
    let colors = ['pastel-1','pastel-2','pastel-3','pastel-4','pastel-5','pastel-6'];
    const topics = [
      'آیا هوش مصنوعی تهدید است یا فرصت؟',
      'آیا مهاجرت به نفع کشور مبدا است یا به ضرر آن؟',
      'آیا فضای مجازی آزادی بیان را تقویت کرده یا تضعیف؟',
      'آیا عدالت مهم‌تر است یا آزادی؟',
      'آیا آموزش حضوری بهتر است یا مجازی؟',
      // ... (بقیه موضوعات)
    ];
    let currentLogic = { symbol: '♦', label: 'منطقی و علمی' };

    function setLogic(symbol, label) {
      currentLogic = { symbol, label };
      document.getElementById('currentLogic').textContent = `${label} (${symbol})`;
      logAction(`♟ منطق مناظره به ${label} (${symbol}) تغییر یافت.`);
    }

    function addPlayer() {
      const name = document.getElementById('newPlayer').value.trim();
      if (name) {
        players.push({ name, score: 0, time: 0 }); // زمان اولیه برای هر بازیکن
        document.getElementById('newPlayer').value = '';
        renderPlayerList();
      }
    }

    function renderPlayerList() {
      document.getElementById('playerList').innerHTML = players.map(p => `<p>${p.name}</p>`).join('');
    }

    function startGame() {
      if (players.length < 2) return alert('حداقل دو بازیکن نیاز است.');
      const randomTopic = topics[Math.floor(Math.random() * topics.length)];
      document.getElementById('topicText').textContent = randomTopic;
      document.getElementById('setup').style.display = 'none';
      document.getElementById('game').style.display = 'block';
      renderPlayers();
      startTurn();
    }

    function renderPlayers() {
      const container = document.getElementById('players');
      container.innerHTML = '';
      players.forEach((p, i) => {
        const div = document.createElement('div');
        div.className = `player ${colors[i % colors.length]} ${i === currentPlayerIndex ? 'turn' : ''}`;
        div.innerHTML = `
          <strong>${p.name}</strong><br>
          🎯 امتیاز: ${p.score}<br>
          <div class="buttons">
            <label for="timeInput${i}">زمان (1 تا 10):</label>
            <input type="number" id="timeInput${i}" min="1" max="10" value="2" onchange="setTime(${i})">
            <button onclick="startTurnForPlayer(${i})">🚀 شروع</button>
            <button onclick="stopTimer()">⏸️ توقف زمان</button>
            <button onclick="addTime(${i})">⏱ زمان بیشتر</button>
            <button onclick="askDivergent(${i})">❓ سوال انحرافی</button>
            <button onclick="changeLogic()">👑 تعویض منطق (شاه)</button>
            <button onclick="vote(${i})">🗳 رأی</button>
            <button onclick="addScore(${i})">➕ امتیاز</button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function setTime(i) {
      const inputValue = parseInt(document.getElementById(`timeInput${i}`).value);
      if (inputValue >= 1 && inputValue <= 10) {
        players[i].time = inputValue; // زمان بر اساس ورودی بازیکن
      }
    }

    function startTurnForPlayer(i) {
      currentPlayerIndex = i;
      timeLeft = players[currentPlayerIndex].time * 10; // زمان بر اساس ورودی بازیکن
      updateTurnDisplay();
      document.getElementById('timeLeft').textContent = timeLeft;
      clearInterval(turnTimer);
      turnTimer = setInterval(() => {
        timeLeft--;
        document.getElementById('timeLeft').textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(turnTimer);
          logAction(`${players[currentPlayerIndex].name} نوبتش تموم شد. استراحت!`);
          currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
          startTurnForPlayer(currentPlayerIndex); // شروع نوبت بعدی
        }
      }, 1000); // کاهش زمان هر ثانیه
    }

    function stopTimer() {
      clearInterval(turnTimer);
      logAction(`${players[currentPlayerIndex].name} زمان را متوقف کرد.`);
    }

    function updateTurnDisplay() {
      document.getElementById('currentPlayerName').textContent = players[currentPlayerIndex].name;
    }

    function logAction(msg) {
      const log = document.getElementById('log');
      const p = document.createElement('p');
      p.textContent = msg;
      log.prepend(p);
    }

    function askDivergent(i) {
      logAction(`👸 ${players[i].name} از سوال انحرافی استفاده کرد.`);
    }

    function addTime(i) {
      players[i].time += 30; // زمان بیشتری به بازیکن اضافه می‌شود
      logAction(`🪖 ${players[i].name} زمان صحبت را افزایش داد.`);
    }

    function vote(i) {
      players[i].score++;
      logAction(`${players[i].name} یک رأی دریافت کرد.`);
      renderPlayers();
      updateScores();
    }

    function addScore(i) {
      const pts = parseInt(prompt('امتیازی که می‌خواهید اضافه کنید:'));
      if (!isNaN(pts)) {
        players[i].score += pts;
        renderPlayers();
        updateScores();
      }
    }

    function changeLogic() {
      const suit = prompt('منطق جدید را انتخاب کنید: ♠ (سیاسی)، ♥ (احساسی)، ♣ (فلسفی)، ♦ (علمی)');
      const logicMap = {
        '♠': 'سیاسی و قدرتی',
        '♥': 'احساسی',
        '♣': 'فلسفی و اخلاقی',
        '♦': 'منطقی و علمی'
      };
      if (logicMap[suit]) setLogic(suit, logicMap[suit]);
    }

    function updateScores() {
      const scoreText = players.map(p => `${p.name}: ${p.score}`).join(' | ');
      document.getElementById('scores').textContent = scoreText;
    }
  </script>

</body>
</html>
